LAG - Обращается к данным из предыдущей строки окна (смещение вперед)
Функцию можно использовать чтобы сравнивать текущее значение строки с предыдущим
Имеет 3 параметра:
- Столбец, значение которого необходимо вернуть
- Количество строк для смещения, по умолчанию 1
- Значение, которое необходимо вернуть если после смещения возвращается NULL

Пример:
SELECT Date, Medium, Conversions, 
LAG(Conversions) OVER(PARTITION BY Date ORDER BY Date) AS 'Lag'
FROM Orders